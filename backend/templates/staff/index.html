{% extends 'layout/base.html' %}

{% block title %}
Trang chủ cho nhân viên
{% endblock %}

{% block content %}
<div class="container flex-grow-1">
    <h3 class="mt-3 mb-4">Các phiên làm việc đang hoạt động</h3>
    {% if sessions %}
    <div class="row">
        {% for s in sessions %}
        <div class="col-md-4 col-6 p-2">
            <div class="card transition-card glass-effect text-white">
                <div class="card-body">
                    <h4 class="card-title text-success">{{ s.room.name }}#{{ s.id }}</h4>
                    <p class="card-text">Người dùng: {{ 'Vãng lai' if s.user.id == 1 else s.user.name }}</p>
                    {% if s.status.name == 'ACTIVE' %}
                    <p class="card-text">Trạng thái: <span class="alert alert-success">{{ s.status.name }}</span></p>
                    {% elif s.status.name == 'FINISHED' %}
                    <p class="card-text">Trạng thái: <span class="alert alert-danger">{{ s.status.name }}</span></p>
                    {% else %}
                    <p class="card-text">Trạng thái: <span class="alert alert-warning">{{ s.status.name }}</span></p>
                    {% endif %}
                    <p class="card-text"> Thời gian bắt đầu: {{ s.start_time.strftime('%H:%M:%S %d-%m-%Y') }}</p>
                    <p class="card-text"> Thời gian kết thúc: {{ s.end_time.strftime('%H:%M:%S %d-%m-%Y') }}</p>
                    <a href="/staffs/{{ s.id }}/order" class="btn btn-primary {{ 'disabled' if s.status.name != 'ACTIVE' }}">Thêm dịch vụ</a>
                    {% if s.status.name == 'BOOKED' %}
                    <a href="/api/sessions/{{ s.id }}/begin_session" class="btn btn-danger">Bắt đầu phiên</a>
                    {% else %}
                    <a href="#" onclick="finishSession({{ s.id }})" class="btn btn-danger {{ 'disabled' if s.status.name != 'ACTIVE' }}">Kết thúc phiên</a>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="alert alert-danger mt-2">Không có phiên làm việc nào!</div>
    {% endif %}
    <h3 class="mt-3 mb-4">Các phiên làm việc đang đặt trước</h3>
    {% if booking_sessions %}
    <div class="row">
        {% for s in booking_sessions %}
        <div class="col-md-4 col-6 p-2">
            <div class="card transition-card glass-effect text-white">
                <div class="card-body">
                    <h4 class="card-title text-success">{{ s.room.name }}#{{ s.id }}</h4>
                    <p class="card-text">Người dùng: {{ 'Vãng lai' if s.user.id == 1 else s.user.name }}</p>
                    {% if s.status.name == 'ACTIVE' %}
                    <p class="card-text">Trạng thái: <span class="alert alert-success">{{ s.status.name }}</span></p>
                    {% elif s.status.name == 'FINISHED' %}
                    <p class="card-text">Trạng thái: <span class="alert alert-danger">{{ s.status.name }}</span></p>
                    {% else %}
                    <p class="card-text">Trạng thái: <span class="alert alert-warning">{{ s.status.name }}</span></p>
                    {% endif %}
                    <p class="card-text"> Thời gian bắt đầu: {{ s.start_time.strftime('%H:%M:%S %d-%m-%Y') }}</p>
                    <p class="card-text"> Thời gian kết thúc: {{ s.end_time.strftime('%H:%M:%S %d-%m-%Y') }}</p>
                    <a href="/staffs/{{ s.id }}/order" class="btn btn-primary {{ 'disabled' if s.status.name != 'ACTIVE' }}">Thêm dịch vụ</a>
                    {% if s.status.name == 'BOOKED' %}
                    <a href="/api/sessions/{{ s.id }}/begin_session" class="btn btn-danger">Bắt đầu phiên</a>
                    {% else %}
                    <a href="/api/sessions/{{ s.id }}/end_session" class="btn btn-danger {{ 'disabled' if s.status.name != 'ACTIVE' }}">Kết thúc phiên</a>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="alert alert-danger mt-2">Không có phiên làm việc nào!</div>
    {% endif %}
</div>
<script src="{{ url_for('static', filename='js/sessions.js') }}"></script>
{% endblock %}